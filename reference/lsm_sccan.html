<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sparse canonical correlations for symptom mapping — lsm_sccan • LESYMAP</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sparse canonical correlations for symptom mapping — lsm_sccan" />
<meta property="og:description" content="Multivariate SCCAN adapted for lesion to symptom mapping purposes.
By default an optimization routine is used to find the best
sparseness value. If you specify sparseness manually, it
will be validated to find the cross-validated correlation that
can be obtained with that sparseness. You can skip the entire
optimization/validation by choosing optimizeSparseness=FALSE.
To understand SCCAN arguments, see sparseDecom2." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LESYMAP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9221</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sparse canonical correlations for symptom mapping</h1>
    
    <div class="hidden name"><code>lsm_sccan.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Multivariate SCCAN adapted for lesion to symptom mapping purposes.
By default an optimization routine is used to find the best
<code>sparseness</code> value. If you specify sparseness manually, it
will be validated to find the cross-validated correlation that
can be obtained with that sparseness. You can skip the entire
optimization/validation by choosing <code>optimizeSparseness=FALSE</code>.
To understand SCCAN arguments, see <code><a href='https://rdrr.io/pkg/ANTsR/man/sparseDecom2.html'>sparseDecom2</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>lsm_sccan</span>(<span class='no'>lesmat</span>, <span class='no'>behavior</span>, <span class='no'>mask</span>, <span class='kw'>showInfo</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>optimizeSparseness</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>validateSparseness</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>pThreshold</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>mycoption</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>robust</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>sparseness</span> <span class='kw'>=</span> <span class='fl'>0.045</span>,
  <span class='kw'>sparseness.behav</span> <span class='kw'>=</span> -<span class='fl'>0.99</span>, <span class='kw'>nvecs</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cthresh</span> <span class='kw'>=</span> <span class='fl'>150</span>, <span class='kw'>its</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>npermsSCCAN</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>smooth</span> <span class='kw'>=</span> <span class='fl'>0.4</span>, <span class='kw'>maxBased</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>directionalSCCAN</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>lesmat</th>
      <td><p>matrix of voxels (columns) and subjects (rows).</p></td>
    </tr>
    <tr>
      <th>behavior</th>
      <td><p>vector of behavioral scores.</p></td>
    </tr>
    <tr>
      <th>mask</th>
      <td><p>antsImage binary mask to put back voxels in image.</p></td>
    </tr>
    <tr>
      <th>showInfo</th>
      <td><p>logical (default=TRUE) display messages</p></td>
    </tr>
    <tr>
      <th>optimizeSparseness</th>
      <td><p>logical (default=TRUE) whether to
run the sparseness optimization routine. If FALSE, the default
sparseness value will be used. If sparseness is manually defined
this flag decides if cross validated correlations will be
computed for the defined sparseness.</p></td>
    </tr>
    <tr>
      <th>validateSparseness</th>
      <td><p>logical (conditional default=TRUE) If
sparseness is manually defined, this flag decides if cross
validated correlations will be computed for the defined sparseness.</p></td>
    </tr>
    <tr>
      <th>pThreshold</th>
      <td><p>(default=0.05) If cross validated
correlations show significance below this value
the results are considered null and an empty
map is returned.</p></td>
    </tr>
    <tr>
      <th>mycoption</th>
      <td><p>(default=1) SCCAN parameter, see <code><a href='https://rdrr.io/pkg/ANTsR/man/sparseDecom2.html'>sparseDecom2</a></code></p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>(ddefault=1) SCCAN parameter, see <code><a href='https://rdrr.io/pkg/ANTsR/man/sparseDecom2.html'>sparseDecom2</a></code></p></td>
    </tr>
    <tr>
      <th>sparseness</th>
      <td><p>(default=1) SCCAN parameter. Decides the proportion
of voxels that will receive a non-zero weight. A positive sparseness
will force the solution of each component to be one sided, i.e.,
voxels cannot have both positive and negative weights. A negative
sparseness allows dual sided solution, where some voxels can have
positive weights and other voxels can have negative weights. Setting
sparseness manually without running the optimization routing is not
recommended. For more, see <code><a href='https://rdrr.io/pkg/ANTsR/man/sparseDecom2.html'>sparseDecom2</a></code>.</p></td>
    </tr>
    <tr>
      <th>sparseness.behav</th>
      <td><p>SCCAN parameter, what sparsness to use for
behavioral scores. Useful only if multiple behavioral scores are
passed. This argument is not optimized, you should not change it
if you are not familiar with SCCAN.</p></td>
    </tr>
    <tr>
      <th>nvecs</th>
      <td><p>(default=1) SCCAN parameter. Normally only
one eigenvector of weights is obtained in LESYMAP. Multiple
maps/eigenvectors can be retrieved for mapping full
deficit profiles in the future. For more, see
<code><a href='https://rdrr.io/pkg/ANTsR/man/sparseDecom2.html'>sparseDecom2</a></code></p></td>
    </tr>
    <tr>
      <th>cthresh</th>
      <td><p>(default=150) SCCAN parameter, see <code><a href='https://rdrr.io/pkg/ANTsR/man/sparseDecom2.html'>sparseDecom2</a></code></p></td>
    </tr>
    <tr>
      <th>its</th>
      <td><p>(default=20) SCCAN parameter, see <code><a href='https://rdrr.io/pkg/ANTsR/man/sparseDecom2.html'>sparseDecom2</a></code></p></td>
    </tr>
    <tr>
      <th>npermsSCCAN</th>
      <td><p>(default=0) SCCAN permutations. In theory can be
used to determine if the cross-correlation between the two sides
(behavior and lesions) is not random. However, LESYMAP uses
k-fold validations, which are faster; this option has not been
tested. For more,  see <code><a href='https://rdrr.io/pkg/ANTsR/man/sparseDecom2.html'>sparseDecom2</a></code>.</p></td>
    </tr>
    <tr>
      <th>smooth</th>
      <td><p>(default=0.4) SCCAN parameter. Determines the
amount of smoothing of weights in image space performed by
<code><a href='https://rdrr.io/pkg/ANTsR/man/sparseDecom2.html'>sparseDecom2</a></code>. The current default value
is somewhat arbitrary, it was not determined through
systematic simulations.</p></td>
    </tr>
    <tr>
      <th>maxBased</th>
      <td><p>(default=FALSE) SCCAN parameter. Removes voxels with
weights smaller than 10% of the peak weight during internal SCCAN
iterations. Although similar to what is done in LESYMAP with standard
SCCAN results, this strategy follows a different route, and produces
different weights. The overall final result is, however, quite similar.
This method is faster then the standard SCCAN call in LESYMAP, but
has not been tested thoroughly. Note that the optimal sparseness
obtained with <code>maxBased=TRUE</code> is not optimal when switching to
<code>maxBased=FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>directionalSCCAN</th>
      <td><p>(default=TRUE) If TRUE, the upper and lower
bounds of sparseness search will be negative. A negative sparseness
permits positive and negative voxel weights, thus finding the
direction of the relationship with behavior.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments received from <code>lesymap</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of objects returned:</p><ul>
<li><p><code>statistic</code> - vector of statistical values</p></li>
<li><p><code>pvalue</code> - vector of pvalues</p></li>
<li><p><code>rawWeights.img</code> - image with raw SCCAN voxel weights</p></li>
<li><p><code>sccan.eig2</code> - SCCAN weight(s) for behavior
column(s).</p></li>
<li><p><code>sccan.ccasummary</code> - SCCAN summary of
projection correlations and permutation-derived pvalues</p></li>
<li><p><code>optimalSparseness</code> - (if optimizeSparseness=TRUE) optimal
value found for sparseness</p></li>
<li><p><code>CVcorrelation.stat</code> - (if optimizeSparseness=TRUE)
Correlation between true and predicted score with k-fold validation
using the optimal sparseness value</p></li>
<li><p><code>CVcorrelation.pval</code> - (if optimizeSparseness=TRUE) p-value
 of the above correlation</p></li>
<li><p><code>sccan.behavior.scaleval</code> - scaling value for behavior</p></li>
<li><p><code>sccan.behavior.centerval</code> - center value for behavior</p></li>
<li><p><code>sccan.lesmat.scaleval</code> - scaling value for lesion matrix</p></li>
<li><p><code>sccan.lesmat.centerval</code> - center value for lesion matrix</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>{
 <span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='no'>lesydata</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/find.package.html'>find.package</a></span>(<span class='st'>'LESYMAP'</span>),<span class='st'>'extdata'</span>)
  <span class='no'>filenames</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.glob.html'>Sys.glob</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>lesydata</span>, <span class='st'>'lesions'</span>, <span class='st'>'*.nii.gz'</span>))
  <span class='no'>behavior</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.glob.html'>Sys.glob</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>lesydata</span>, <span class='st'>'behavior'</span>, <span class='st'>'behavior.txt'</span>))
  <span class='no'>behavior</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span>(<span class='no'>behavior</span>,<span class='kw'>header</span><span class='kw'>=</span><span class='fl'>FALSE</span>)[,<span class='fl'>1</span>]
  <span class='no'>avg</span> <span class='kw'>=</span> <span class='fu'>antsAverageImages</span>(<span class='no'>filenames</span>)
  <span class='no'>mask</span> <span class='kw'>=</span> <span class='fu'>thresholdImage</span>(<span class='no'>avg</span>, <span class='fl'>0.1</span>, <span class='fl'>Inf</span>)
  <span class='no'>lesmat</span> <span class='kw'>=</span> <span class='fu'>imagesToMatrix</span>(<span class='no'>filenames</span>,<span class='no'>mask</span>)
  <span class='no'>result</span> <span class='kw'>=</span> <span class='fu'>lsm_sccan</span>(<span class='no'>lesmat</span>, <span class='no'>behavior</span>,
       <span class='kw'>optimizeSparseness</span><span class='kw'>=</span><span class='no'>F</span>, <span class='kw'>sparseness</span><span class='kw'>=</span><span class='fl'>0.8</span>, <span class='kw'>mask</span> <span class='kw'>=</span> <span class='no'>mask</span>)
 }
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dorian Pustina.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


